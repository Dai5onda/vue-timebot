(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-b666"],{A6Kr:function(t,e,i){"use strict";var a=i("Slkr");i.n(a).a},"Cu+X":function(t,e,i){"use strict";var a=i("Toi6");i.n(a).a},G2KY:function(t,e,i){"use strict";i.d(e,"a",function(){return d}),i.d(e,"f",function(){return u}),i.d(e,"b",function(){return p}),i.d(e,"d",function(){return m}),i.d(e,"e",function(){return h}),i.d(e,"c",function(){return f});var a=i("4d7F"),s=i.n(a),n=(i("aHnO"),i("P2sY")),r=i.n(n),o=i("QbLZ"),l=i.n(o),c=i("L2JU"),d={data:function(){return{pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()},shortcuts:[{text:"Last week",onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-6048e5),t.$emit("pick",[i,e])}},{text:"Last month",onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-2592e6),t.$emit("pick",[i,e])}},{text:"Last 3 months",onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-7776e6),t.$emit("pick",[i,e])}}]},isAnswered:!0}},methods:{formatDate:function(t){if(t){var e=t.getDate();e<10&&(e="0"+e);var i=t.getMonth()+1;i<10&&(i="0"+i);var a=t.getFullYear();return a<10&&(a="0"+a),a+"-"+i+"-"+e}}},computed:l()({},Object(c.b)(["rangeDate"]),{date:{get:function(){return this.rangeDate},set:function(t){this.$store.dispatch("setRangeDate",t)}}}),created:function(){},mounted:function(){if(this.date){var t=new Date("2018-08-18"),e=new Date("2018-08-12");e.setTime(e.getTime()-6048e5),this.$store.dispatch("setRangeDate",[this.formatDate(e),this.formatDate(t)])}}},u={data:function(){var t=function(t,e,i){e?i():i(new Error)},e=function(t,e,i){e?i():i(new Error)};return{rules:{type:[{required:!0,message:"type is required",trigger:"change"}],date:[{validator:e,type:"date",required:!0,message:"Date is required",trigger:"blur"}],time:[{validator:e,type:"datetime",required:!0,message:"Time is required",trigger:"blur"}],title:[{required:!0,message:"title is required",trigger:"blur"}],id:[{validator:t,required:!0,message:"User is required",trigger:"change"}],project:[{validator:function(t,e,i){e?i():i(new Error)},required:!0,message:"Project is required",trigger:"change"}],name:[{validator:t,required:!0,message:"Name of project is requires",trigger:"change"}],team:[{required:!0,message:"Team is requires",trigger:"change"}]}}}},p={data:function(){return{dialogStatus:"",dialogFormVisible:!1,dialogViewVisible:!1,dialogFormLoading:!1,textMap:{update:"Edit",create:"Create",view:"View"},temp:{id:void 0,type:"",date:"",attributes:{"is-active":!1},relationships:{team:{data:{}},user:{data:{}},project:{data:{}}}}}},methods:{handleUpdate:function(t){var e=this;this.temp=r()({},t),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},handleCreate:function(){var t=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},handleView:function(t){this.temp=r()({},t),this.dialogStatus="view",this.dialogViewVisible=!0},resetTemp:function(){this.temp={id:void 0,type:"",date:"",attributes:{"is-active":!1},relationships:{team:{data:{}},user:{data:{}},project:{data:{}}}}}}},m={data:function(){return{}},methods:{handleSizeChange:function(t){var e=this;this.$store.dispatch("actionEntityTable/setPagination",{type:"limit",value:t}).then(function(){e.getList()})},handleCurrentChange:function(t){var e=this;this.$store.dispatch("actionEntityTable/setPagination",{type:"page",value:t}).then(function(){e.getList()})}}},h={beforeDestroy:function(){this.$store.dispatch("actionEntityTable/clearStore")},methods:{getList:function(){var t=this;return new s.a(function(e,i){t.$store.dispatch("actionEntityTable/setLoader",!0),t.$store.dispatch("actionEntityTable/fetchList",t.type).then(function(){t.$store.dispatch("actionEntityTable/setLoader",!1),e()})})},removeEntity:function(t,e){var i=this;this.$confirm("This will permanently delete the entity. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){i.$store.dispatch("actionEntityTable/deleteEntity",{row:t,type:i.type}).then(function(){i.$message({message:"Project was deleted",type:"success"}),t.status=e})}).catch(function(){i.$message({type:"info",message:"Delete canceled"})})},createEntity:function(t){var e=this;return new s.a(function(i,a){e.$refs.dataForm.validate(function(a){a&&(e.dialogFormLoading=!0,e.$store.dispatch("actionEntityTable/createEntity",{row:t,type:e.type}).then(function(t){e.dialogFormVisible=!1,e.dialogFormLoading=!1,e.$notify({title:"Success",message:e.setMessageName(e.type)+" was created",type:"success",duration:2e3}),i()}).catch(function(){e.dialogFormVisible=!1,e.dialogFormLoading=!1}))})})},updateEntity:function(t){var e=this;this.$refs.dataForm.validate(function(i){i&&(e.dialogFormLoading=!0,e.$store.dispatch("actionEntityTable/updateEntity",{row:t,type:e.type}).then(function(){e.dialogFormVisible=!1,e.dialogFormLoading=!1,e.$notify({title:"Success",message:e.setMessageName(e.type)+" was updated",type:"success",duration:2e3})}).catch(function(t){console.log(t),e.dialogFormVisible=!1,e.dialogFormLoading=!1}))})},setMessageName:function(t){switch(t){case"projects":return"Project";case"time-entries":return"Time entry";case"users":return"User";case"teams":return"Team";case"holidays":return"Holiday";case"absences":return"Absence";case"admins":return"Admin"}},remoteGetProjects:function(t){var e=this;"string"!=typeof t&&(t=this.temp&&this.getIncluded(this.temp.relationships.project.data.id)||""),this.loading=!0,this.$store.dispatch("actionEntityTable/fetchEntityByName",{type:"projects",query:t}).then(function(){e.loading=!1})},remoteGetUsers:function(t){var e=this;"string"!=typeof t&&(t=this.temp&&this.getIncluded(this.temp.relationships.user.data.id)||""),this.loading=!0,this.$store.dispatch("actionEntityTable/fetchEntityByName",{type:"users",query:t}).then(function(){e.loading=!1})},filter:function(){var t=this;return new s.a(function(e,i){t.$store.dispatch("actionEntityTable/setLoader",!0),t.$store.dispatch("actionEntityTable/setFilter",t.entity).then(function(){t.$store.dispatch("actionEntityTable/fetchList",t.type).finally(function(){t.$store.dispatch("actionEntityTable/setLoader",!1),e()})})})}}},f={methods:{getIncluded:function(t){if(this.included(this.type)){var e=this.included(this.type).find(function(e){if(e.id===t)return e});if(e)return e.attributes.name}}}}},Mz3J:function(t,e,i){"use strict";var a=i("QbLZ"),s=i.n(a),n=i("G2KY"),r=i("L2JU"),o={name:"Pagination",mixins:[n.d,n.e],props:{type:{type:String,require:!0,default:""}},computed:s()({},Object(r.b)({pagination:"actionEntityTable/pagination"})),methods:{handleSizeChange:function(t){var e=this;this.$store.dispatch("actionEntityTable/setPagination",{limit:t}).then(function(){e.$store.dispatch("actionEntityTable/setLoader",!0),e.getList().then(function(){e.$store.dispatch("actionEntityTable/setLoader",!1)})})},handleCurrentChange:function(t){var e=this;this.$store.dispatch("actionEntityTable/setPagination",{page:t}).then(function(){e.$store.dispatch("actionEntityTable/setLoader",!0),e.getList().then(function(){e.$store.dispatch("actionEntityTable/setLoader",!1),e.$scrollTo("body",1e3)})})}}},l=(i("A6Kr"),i("KHd+")),c=Object(l.a)(o,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pagination-container"},[e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.pagination.total>0,expression:"pagination.total > 0"}],attrs:{"current-page":this.pagination.page,"page-sizes":[10,20,30,50],"page-size":this.pagination.limit,total:this.pagination.total,background:"",layout:"total, sizes, prev, pager, next"},on:{"size-change":this.handleSizeChange,"current-change":this.handleCurrentChange}})],1)},[],!1,null,"26aa7921",null);c.options.__file="index.vue";e.a=c.exports},Slkr:function(t,e,i){},TFXo:function(t,e,i){"use strict";i.r(e);var a=i("QbLZ"),s=i.n(a),n=i("L2JU"),r=i("G2KY"),o={name:"Filters",mixins:[r.e,r.c],data:function(){return{type:"time-entries",searchParams:{ticket:"",date:[],users:[],projects:[]}}},computed:s()({},Object(n.b)({filterable:"actionEntityTable/filterable"}),{entity:function(){return{date_from:this.searchParams.date[0],date_to:this.searchParams.date[1],by_projects:this.searchParams.projects,by_users:this.searchParams.users,with_ticket:this.searchParams.ticket}}}),methods:{clearFilter:function(){this.searchParams={ticket:"",date:[],users:[],projects:[]}}}},l=i("KHd+"),c=Object(l.a)(o,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"time-entries-filters-container"},[i("div",{staticClass:"time-entries-filters"},[i("div",{staticClass:"filters-label"},[t._v("Users name"),i("el-select",{attrs:{filterable:"",remote:"",multiple:"",placeholder:"Please enter a users","remote-method":t.remoteGetUsers},on:{focus:t.remoteGetUsers},model:{value:t.searchParams.users,callback:function(e){t.$set(t.searchParams,"users",e)},expression:"searchParams.users"}},t._l(t.filterable("users"),function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),i("div",{staticClass:"time-entries-filters"},[i("div",{staticClass:"filters-label"},[t._v("Projects name"),i("el-select",{attrs:{filterable:"",remote:"",multiple:"",placeholder:"Please enter a projects","remote-method":t.remoteGetProjects},on:{focus:t.remoteGetProjects},model:{value:t.searchParams.projects,callback:function(e){t.$set(t.searchParams,"projects",e)},expression:"searchParams.projects"}},t._l(t.filterable("projects"),function(t){return i("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],1)]),i("div",{staticClass:"time-entries-filters"},[i("div",{staticClass:"filters-label"},[t._v("Details"),i("el-input",{attrs:{type:"textarea"},model:{value:t.searchParams.ticket,callback:function(e){t.$set(t.searchParams,"ticket",e)},expression:"searchParams.ticket"}})],1)]),i("div",{staticClass:"time-entries-filters"},[i("div",{staticClass:"filters-label"},[t._v("Date"),i("el-date-picker",{staticStyle:{with:"100%"},attrs:{format:"yyyy-MM-dd",type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"Start date","end-placeholder":"End date",placeholder:"Please pick a date","prefix-icon":"date-calendar"},model:{value:t.searchParams.date,callback:function(e){t.$set(t.searchParams,"date",e)},expression:"searchParams.date"}})],1)]),i("div",{staticStyle:{margin:"19px 0 0"}},[i("div",[i("el-button",{staticClass:"el-button-filter",on:{click:t.filter}},[t._v("Filter")]),i("el-button",{staticClass:"el-button-clear-filter",attrs:{type:"info"},on:{click:t.clearFilter}},[t._v("Clear Filters")])],1)])])},[],!1,null,null,null);c.options.__file="filters.vue";var d=c.exports,u={name:"TimeEntriesTable",components:{pagination:i("Mz3J").a},mixins:[r.f,r.b,r.e,r.c],data:function(){return{multipleSelection:[],tableKey:0,type:"time-entries",loading:!1,jsonFields:{user:{field:"attributes.date",callback:function(t){return""+t}}}}},computed:s()({},Object(n.b)({list:"actionEntityTable/list",included:"actionEntityTable/included",filterable:"actionEntityTable/filterable",loader:"actionEntityTable/loader"}),{entity:function(){return{date:this.temp.attributes.date,time:this.temp.attributes.time,minutes:this.temp.attributes.time,details:this.temp.attributes.details,trello_labels:this.temp.attributes.trello_labels,user_id:this.temp.relationships.user.data.id,project_id:this.temp.relationships.project.data.id}}}),created:function(){this.getList()},methods:{update:function(){var t={id:this.temp.id,time_entry:this.entity};this.updateEntity(t)},create:function(){var t={time_entry:this.entity};this.createEntity(t)},handleSelectionChange:function(t){this.multipleSelection=t},preRemote:function(){this.remoteGetProjects(),this.remoteGetUsers()}}},p=(i("Cu+X"),Object(l.a)(u,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",[i("div",{staticClass:"position-create-new-category"},[i("el-button",{staticClass:"filter-item create-new-category",attrs:{type:"primary"},on:{click:t.handleCreate}},[t._v("Add new time entry")])],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loader,expression:"loader"}],key:t.tableKey,staticStyle:{width:"100%"},attrs:{data:t.list(t.type),border:"",fit:"","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),i("el-table-column",{attrs:{label:t.$t("table.id"),align:"center",width:"65"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.id))])]}}])}),i("el-table-column",{attrs:{label:"User"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t.getIncluded(e.row.relationships.user.data.id)))])]}}])}),i("el-table-column",{attrs:{label:"Project"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t.getIncluded(e.row.relationships.project.data.id)))])]}}])}),i("el-table-column",{attrs:{label:"Date"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.attributes.date))])]}}])}),i("el-table-column",{attrs:{label:"Time"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.attributes.time))])]}}])}),i("el-table-column",{attrs:{label:"Details"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.attributes.details))])]}}])}),i("el-table-column",{attrs:{label:t.$t("table.actions"),width:"230","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticStyle:{"text-align":"center"}},[i("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(i){t.handleView(e.row)}}},[t._v("View")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){t.handleUpdate(e.row)}}},[t._v(t._s(t.$t("table.edit")))]),"deleted"!==e.row.status?i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){t.removeEntity(e.row,"deleted")}}},[t._v(t._s(t.$t("table.delete")))]):t._e()],1)]}}])})],1),t.list(t.type).length?i("pagination",{attrs:{type:t.type}}):t._e(),i("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{open:t.preRemote,"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{ref:"dataForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{rules:t.rules,model:t.temp.attributes,"label-position":"left","label-width":"70px"}},[i("el-form-item",{attrs:{label:"User"}},[i("el-select",{attrs:{filterable:"",remote:"",placeholder:"Please enter a keyword","remote-method":t.remoteGetUsers,loading:t.loading},on:{focus:t.remoteGetUsers},model:{value:t.temp.relationships.user.data.id,callback:function(e){t.$set(t.temp.relationships.user.data,"id",e)},expression:"temp.relationships.user.data.id"}},t._l(t.filterable("users"),function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),i("el-form-item",{attrs:{label:"Project"}},[i("el-select",{attrs:{filterable:"",remote:"",placeholder:"Please enter a keyword","remote-method":t.remoteGetProjects},on:{focus:t.remoteGetProjects},model:{value:t.temp.relationships.project.data.id,callback:function(e){t.$set(t.temp.relationships.project.data,"id",e)},expression:"temp.relationships.project.data.id"}},t._l(t.filterable("projects"),function(t){return i("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],1),i("el-form-item",{attrs:{label:t.$t("table.date"),prop:"date"}},[i("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"date",placeholder:"Please pick a date"},model:{value:t.temp.attributes.date,callback:function(e){t.$set(t.temp.attributes,"date",e)},expression:"temp.attributes.date"}})],1),i("el-form-item",{attrs:{label:"Time",prop:"time"}},[i("el-time-select",{attrs:{"picker-options":{start:"00:00",step:"00:15",end:"18:30"},placeholder:"Please pick a time"},model:{value:t.temp.attributes.time,callback:function(e){t.$set(t.temp.attributes,"time",e)},expression:"temp.attributes.time"}})],1),i("el-form-item",{attrs:{label:"Details",prop:"timestamp"}},[i("el-input",{attrs:{type:"details",placeholder:"Write smth"},model:{value:t.temp.attributes.details,callback:function(e){t.$set(t.temp.attributes,"details",e)},expression:"temp.attributes.details"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v(t._s(t.$t("table.cancel")))]),"create"===t.dialogStatus?i("el-button",{attrs:{loading:t.dialogFormLoading,type:"primary"},on:{click:function(e){t.create()}}},[t._v("Create")]):i("el-button",{attrs:{type:"primary",loading:t.dialogFormLoading},on:{click:t.update}},[t._v(t._s(t.$t("table.confirm")))])],1)],1),i("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogViewVisible},on:{"update:visible":function(e){t.dialogViewVisible=e}}},[i("div",{staticClass:"view-flex"},[i("div",[i("strong",[t._v("Id")]),i("p",[t._v(t._s(t.temp.id))])]),i("div",[i("strong",[t._v("User")]),i("p",[t._v(t._s(t.getIncluded(t.temp.relationships.user.data.id)))])]),i("div",[i("strong",[t._v("Date")]),i("p",[t._v(t._s(t.temp.attributes.date))])]),i("div",[i("strong",[t._v("Details")]),i("p",[t._v(t._s(t.temp.attributes.details))])]),i("div",[i("strong",[t._v("Minutes")]),i("p",[t._v(t._s(t.temp.attributes.time))])]),i("div",[i("strong",[t._v("Project")]),i("p",[t._v(t._s(t.temp.relationships.project.data.id))])]),i("div",[i("strong",[t._v("Ticket")]),i("p",[t._v(t._s(t.temp.attributes.details))])]),i("div",[i("strong",[t._v("Trello labels")]),i("p",[t._v(t._s(t.temp.attributes["trello-labels"]))])])])])],1)])},[],!1,null,"0085e587",null));p.options.__file="time-entriesTable.vue";var m={name:"TimeEntries",components:{filters:d,timeEntriesTable:p.exports},data:function(){return{}},computed:s()({},Object(n.b)({loader:"actionEntityTable/loader"}))},h=Object(l.a)(m,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:this.loader,expression:"loader"}]},[e("div",{staticClass:"timebot-header"},[this._v("Time entries")]),e("filters"),e("time-entries-table")],1)},[],!1,null,null,null);h.options.__file="index.vue";e.default=h.exports},Toi6:function(t,e,i){},aHnO:function(t,e,i){t.exports={default:i("tbFO"),__esModule:!0}},pGU1:function(t,e,i){var a=i("Y7ZC"),s=i("vwuL").f,n=i("5K7Z");a(a.S,"Reflect",{deleteProperty:function(t,e){var i=s(n(t),e);return!(i&&!i.configurable)&&delete t[e]}})},tbFO:function(t,e,i){i("pGU1"),t.exports=i("WEpk").Reflect.deleteProperty}}]);