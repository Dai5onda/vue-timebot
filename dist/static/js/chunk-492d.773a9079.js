(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-492d"],{"5FeN":function(t,e,a){"use strict";a.r(e);var i=a("m1cH"),n=a.n(i),s=a("gDS+"),r=a.n(s),o=a("QbLZ"),c=a.n(o),l=a("G2KY"),d=a("L2JU"),u={name:"Estimations",components:{pagination:a("Mz3J").a},mixins:[l.e,l.c,l.a],data:function(){return{type:"estimationReports",searchParams:{projects:""},json_fields:{Project:"project",Details:"details",Collaborators:"collaborators","Created at":"created_at","Trello labels":"trello_labels",Estimate:"estimate","Total time":"total_time",Status:"status"},jsonData:[]}},computed:c()({},Object(d.b)({list:"actionEntityTable/list",filterable:"actionEntityTable/filterable",loader:"actionEntityTable/loader"})),mounted:function(){this.setParams()},methods:{setParams:function(t){var e=this;null===t&&(this.date=[new Date,new Date]),this.searchParams.projects&&(this.$store.dispatch("actionEntityTable/setLoader",!0),this.$store.dispatch("actionEntityTable/setFilter",{by_projects:[this.searchParams.projects],date_from:this.date[0],date_to:this.date[1]}).then(function(){e.getList().then(function(){e.$store.dispatch("actionEntityTable/setLoader",!1),e.getJsonStructure()})}))},getJsonStructure:function(){var t=JSON.parse(r()([].concat(n()(this.list("estimationReports")))));t.forEach(function(t){var e="";t.collaborators.forEach(function(t){e+=t.name+" "}),t.collaborators=e}),this.jsonData=t}}},p=(a("ka7y"),a("KHd+")),h=Object(p.a)(u,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loader,expression:"loader"}]},[a("div",{staticClass:"timebot-header"},[t._v("Estimations")]),a("div",{staticClass:"time-entries-filters-container"},[a("div",{staticClass:"time-entries-filters"},[a("div",{staticClass:"filters-label"},[t._v("Projects name"),a("el-select",{attrs:{filterable:"",remote:"",placeholder:"Please enter a projects",icon:"arrow-up","remote-method":t.remoteGetProjects},on:{focus:t.remoteGetProjects,change:t.setParams},model:{value:t.searchParams.projects,callback:function(e){t.$set(t.searchParams,"projects",e)},expression:"searchParams.projects"}},t._l(t.filterable("projects"),function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],1)]),a("div",{staticClass:"time-entries-filters"},[a("div",{staticClass:"filters-label"},[t._v("Date"),a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions,"start-placeholder":"Start date","end-placeholder":"End date",placeholder:"Please pick a date","prefix-icon":"date-calendar"},on:{change:t.setParams},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)]),a("div",{staticClass:"time-entries-filters"},[a("div",{staticClass:"filters-label-csv"},[a("download-excel",{directives:[{name:"show",rawName:"v-show",value:t.jsonData.length,expression:"jsonData.length"}],attrs:{data:t.jsonData,fields:t.json_fields,type:"csv",name:"time-reports.xls"}},[a("el-button",[t._v("Download CSV")])],1)],1)])]),a("el-table",{attrs:{data:t.list("estimationReports")}},[a("el-table-column",{attrs:{prop:"project",label:"Project"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.projects,function(e){return a("span",{key:e.id},[t._v(t._s(e.name)+" ")])})}}])}),a("el-table-column",{attrs:{prop:"details",label:"Details"}}),a("el-table-column",{attrs:{label:"Collaborators"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.collaborators,function(e){return a("span",{key:e.id},[t._v(t._s(e.name)+" ")])})}}])}),a("el-table-column",{attrs:{prop:"created_at",label:"Created at"}}),a("el-table-column",{attrs:{prop:"trello_labels",label:"Trello labels"}}),a("el-table-column",{attrs:{prop:"estimate",label:"Estimate"}}),a("el-table-column",{attrs:{prop:"total_time",label:"Total time"}}),a("el-table-column",{attrs:{prop:"status",label:"Status"}})],1),t.list(t.type).length?a("pagination",{attrs:{type:t.type}}):t._e()],1)},[],!1,null,"606418e1",null);h.options.__file="index.vue";e.default=h.exports},A6Kr:function(t,e,a){"use strict";var i=a("Slkr");a.n(i).a},G2KY:function(t,e,a){"use strict";a.d(e,"a",function(){return d}),a.d(e,"f",function(){return u}),a.d(e,"b",function(){return p}),a.d(e,"d",function(){return h}),a.d(e,"e",function(){return m}),a.d(e,"c",function(){return f});var i=a("4d7F"),n=a.n(i),s=(a("aHnO"),a("P2sY")),r=a.n(s),o=a("QbLZ"),c=a.n(o),l=a("L2JU"),d={data:function(){return{pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()},shortcuts:[{text:"Last week",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"Last month",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"Last 3 months",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},isAnswered:!0}},methods:{formatDate:function(t){if(t){var e=t.getDate();e<10&&(e="0"+e);var a=t.getMonth()+1;a<10&&(a="0"+a);var i=t.getFullYear();return i<10&&(i="0"+i),i+"-"+a+"-"+e}}},computed:c()({},Object(l.b)(["rangeDate"]),{date:{get:function(){return this.rangeDate},set:function(t){this.$store.dispatch("setRangeDate",t)}}}),created:function(){},mounted:function(){if(this.date){var t=new Date("2018-08-18"),e=new Date("2018-08-12");e.setTime(e.getTime()-6048e5),this.$store.dispatch("setRangeDate",[this.formatDate(e),this.formatDate(t)])}}},u={data:function(){var t=function(t,e,a){e?a():a(new Error)},e=function(t,e,a){e?a():a(new Error)};return{rules:{type:[{required:!0,message:"type is required",trigger:"change"}],date:[{validator:e,type:"date",required:!0,message:"Date is required",trigger:"blur"}],time:[{validator:e,type:"datetime",required:!0,message:"Time is required",trigger:"blur"}],title:[{required:!0,message:"title is required",trigger:"blur"}],id:[{validator:t,required:!0,message:"User is required",trigger:"change"}],project:[{validator:function(t,e,a){e?a():a(new Error)},required:!0,message:"Project is required",trigger:"change"}],name:[{validator:t,required:!0,message:"Name of project is requires",trigger:"change"}],team:[{required:!0,message:"Team is requires",trigger:"change"}]}}}},p={data:function(){return{dialogStatus:"",dialogFormVisible:!1,dialogViewVisible:!1,dialogFormLoading:!1,textMap:{update:"Edit",create:"Create",view:"View"},temp:{id:void 0,type:"",date:"",attributes:{"is-active":!1},relationships:{team:{data:{}},user:{data:{}},project:{data:{}}}}}},methods:{handleUpdate:function(t){var e=this;this.temp=r()({},t),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},handleCreate:function(){var t=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},handleView:function(t){this.temp=r()({},t),this.dialogStatus="view",this.dialogViewVisible=!0},resetTemp:function(){this.temp={id:void 0,type:"",date:"",attributes:{"is-active":!1},relationships:{team:{data:{}},user:{data:{}},project:{data:{}}}}}}},h={data:function(){return{}},methods:{handleSizeChange:function(t){var e=this;this.$store.dispatch("actionEntityTable/setPagination",{type:"limit",value:t}).then(function(){e.getList()})},handleCurrentChange:function(t){var e=this;this.$store.dispatch("actionEntityTable/setPagination",{type:"page",value:t}).then(function(){e.getList()})}}},m={beforeDestroy:function(){this.$store.dispatch("actionEntityTable/clearStore")},methods:{getList:function(){var t=this;return new n.a(function(e,a){t.$store.dispatch("actionEntityTable/setLoader",!0),t.$store.dispatch("actionEntityTable/fetchList",t.type).then(function(){t.$store.dispatch("actionEntityTable/setLoader",!1),e()})})},removeEntity:function(t,e){var a=this;this.$confirm("This will permanently delete the entity. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){a.$store.dispatch("actionEntityTable/deleteEntity",{row:t,type:a.type}).then(function(){a.$message({message:"Project was deleted",type:"success"}),t.status=e})}).catch(function(){a.$message({type:"info",message:"Delete canceled"})})},createEntity:function(t){var e=this;return new n.a(function(a,i){e.$refs.dataForm.validate(function(i){i&&(e.dialogFormLoading=!0,e.$store.dispatch("actionEntityTable/createEntity",{row:t,type:e.type}).then(function(t){e.dialogFormVisible=!1,e.dialogFormLoading=!1,e.$notify({title:"Success",message:e.setMessageName(e.type)+" was created",type:"success",duration:2e3}),a()}).catch(function(){e.dialogFormVisible=!1,e.dialogFormLoading=!1}))})})},updateEntity:function(t){var e=this;this.$refs.dataForm.validate(function(a){a&&(e.dialogFormLoading=!0,e.$store.dispatch("actionEntityTable/updateEntity",{row:t,type:e.type}).then(function(){e.dialogFormVisible=!1,e.dialogFormLoading=!1,e.$notify({title:"Success",message:e.setMessageName(e.type)+" was updated",type:"success",duration:2e3})}).catch(function(t){console.log(t),e.dialogFormVisible=!1,e.dialogFormLoading=!1}))})},setMessageName:function(t){switch(t){case"projects":return"Project";case"time-entries":return"Time entry";case"users":return"User";case"teams":return"Team";case"holidays":return"Holiday";case"absences":return"Absence";case"admins":return"Admin"}},remoteGetProjects:function(t){var e=this;"string"!=typeof t&&(t=this.temp&&this.getIncluded(this.temp.relationships.project.data.id)||""),this.loading=!0,this.$store.dispatch("actionEntityTable/fetchEntityByName",{type:"projects",query:t}).then(function(){e.loading=!1})},remoteGetUsers:function(t){var e=this;"string"!=typeof t&&(t=this.temp&&this.getIncluded(this.temp.relationships.user.data.id)||""),this.loading=!0,this.$store.dispatch("actionEntityTable/fetchEntityByName",{type:"users",query:t}).then(function(){e.loading=!1})},filter:function(){var t=this;return new n.a(function(e,a){t.$store.dispatch("actionEntityTable/setLoader",!0),t.$store.dispatch("actionEntityTable/setFilter",t.entity).then(function(){t.$store.dispatch("actionEntityTable/fetchList",t.type).finally(function(){t.$store.dispatch("actionEntityTable/setLoader",!1),e()})})})}}},f={methods:{getIncluded:function(t){if(this.included(this.type)){var e=this.included(this.type).find(function(e){if(e.id===t)return e});if(e)return e.attributes.name}}}}},Mz3J:function(t,e,a){"use strict";var i=a("QbLZ"),n=a.n(i),s=a("G2KY"),r=a("L2JU"),o={name:"Pagination",mixins:[s.d,s.e],props:{type:{type:String,require:!0,default:""}},computed:n()({},Object(r.b)({pagination:"actionEntityTable/pagination"})),methods:{handleSizeChange:function(t){var e=this;this.$store.dispatch("actionEntityTable/setPagination",{limit:t}).then(function(){e.$store.dispatch("actionEntityTable/setLoader",!0),e.getList().then(function(){e.$store.dispatch("actionEntityTable/setLoader",!1)})})},handleCurrentChange:function(t){var e=this;this.$store.dispatch("actionEntityTable/setPagination",{page:t}).then(function(){e.$store.dispatch("actionEntityTable/setLoader",!0),e.getList().then(function(){e.$store.dispatch("actionEntityTable/setLoader",!1),e.$scrollTo("body",1e3)})})}}},c=(a("A6Kr"),a("KHd+")),l=Object(c.a)(o,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pagination-container"},[e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.pagination.total>0,expression:"pagination.total > 0"}],attrs:{"current-page":this.pagination.page,"page-sizes":[10,20,30,50],"page-size":this.pagination.limit,total:this.pagination.total,background:"",layout:"total, sizes, prev, pager, next"},on:{"size-change":this.handleSizeChange,"current-change":this.handleCurrentChange}})],1)},[],!1,null,"26aa7921",null);l.options.__file="index.vue";e.a=l.exports},Slkr:function(t,e,a){},aHnO:function(t,e,a){t.exports={default:a("tbFO"),__esModule:!0}},"gDS+":function(t,e,a){t.exports={default:a("oh+g"),__esModule:!0}},ka7y:function(t,e,a){"use strict";var i=a("qYm8");a.n(i).a},"oh+g":function(t,e,a){var i=a("WEpk"),n=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return n.stringify.apply(n,arguments)}},pGU1:function(t,e,a){var i=a("Y7ZC"),n=a("vwuL").f,s=a("5K7Z");i(i.S,"Reflect",{deleteProperty:function(t,e){var a=n(s(t),e);return!(a&&!a.configurable)&&delete t[e]}})},qYm8:function(t,e,a){},tbFO:function(t,e,a){a("pGU1"),t.exports=a("WEpk").Reflect.deleteProperty}}]);