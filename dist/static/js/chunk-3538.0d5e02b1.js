(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3538"],{"+na8":function(t,e,a){"use strict";a.r(e);var i=a("QbLZ"),n=a.n(i),r=a("G2KY"),s=a("L2JU"),o=a("kKwK"),l=a("itRl"),c={name:"ProjectsTable",components:{pagination:a("Mz3J").a},mixins:[r.f,r.b,r.e],data:function(){return{multipleSelection:[],tableKey:0,type:"projects"}},computed:n()({},Object(s.b)({list:"actionEntityTable/list",loader:"actionEntityTable/loader"}),{entity:function(){return{name:this.temp.attributes.name,alias:this.temp.attributes.alias,team_id:this.temp.relationships.team.data.id}}}),created:function(){var t=this;this.getList().then(function(){t.$store.dispatch("actionEntityTable/fetchList","teams")})},methods:{create:function(){var t={project:this.entity};this.createEntity(t)},update:function(){var t={id:this.temp.id,project:this.entity};this.updateEntity(t)},handleSelectionChange:function(t){this.multipleSelection=t},setTeam:function(t){if(t){var e=this.list("teams").find(function(e){if(e.id===t.id)return e});if(e)return e.attributes.name}}}},d=(a("oOii"),a("KHd+")),u=Object(d.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("div",{staticStyle:{display:"flex"}},[a("div",{staticClass:"position-create-new-category"},[a("el-button",{staticClass:"filter-item create-new-category",attrs:{type:"primary"},on:{click:t.handleCreate}},[t._v("Add new project")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loader,expression:"loader"}],key:t.tableKey,ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.list(t.type),border:"",fit:"","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),a("el-table-column",{attrs:{label:t.$t("table.id"),align:"center",width:"65"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.id))])]}}])}),a("el-table-column",{attrs:{label:"Name"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.attributes.name))])]}}])}),a("el-table-column",{attrs:{label:"Alias"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.attributes.alias))])]}}])}),a("el-table-column",{attrs:{label:"Team"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.setTeam(e.row.relationships.team.data)))])]}}])}),a("el-table-column",{attrs:{label:t.$t("table.actions"),width:"230","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){t.handleView(e.row)}}},[t._v("View")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.handleUpdate(e.row)}}},[t._v(t._s(t.$t("table.edit")))]),"deleted"!==e.row.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.removeEntity(e.row,"deleted")}}},[t._v(t._s(t.$t("table.delete")))]):t._e()]}}])})],1),t.list(t.type).length?a("pagination",{attrs:{type:t.type}}):t._e()],1),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{rules:t.rules,model:t.temp.attributes,"label-position":"left","label-width":"70px"}},[a("el-form-item",{attrs:{label:"Name",prop:"name"}},[a("el-input",{attrs:{placeholder:"Please input",clearable:""},model:{value:t.temp.attributes.name,callback:function(e){t.$set(t.temp.attributes,"name",e)},expression:"temp.attributes.name"}})],1),a("el-form-item",{attrs:{label:"Team"}},[t.temp.relationships.team.data?a("el-select",{attrs:{placeholder:"Select"},model:{value:t.temp.relationships.team.data.id,callback:function(e){t.$set(t.temp.relationships.team.data,"id",e)},expression:"temp.relationships.team.data.id"}},t._l(t.list("teams"),function(t){return a("el-option",{key:t.id,attrs:{label:t.attributes.name,value:t.id}})})):a("el-select",{attrs:{placeholder:"Select"},model:{value:t.temp.relationships.team.data,callback:function(e){t.$set(t.temp.relationships.team,"data",e)},expression:"temp.relationships.team.data"}},t._l(t.list("teams"),function(t){return a("el-option",{key:t.id,attrs:{label:t.attributes.name,value:t}})}))],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v(t._s(t.$t("table.cancel")))]),"create"===t.dialogStatus?a("el-button",{attrs:{type:"primary",loading:t.dialogFormLoading},on:{click:t.create}},[t._v(t._s(t.$t("table.confirm")))]):a("el-button",{attrs:{type:"primary",loading:t.dialogFormLoading},on:{click:t.update}},[t._v("Update")])],1)],1),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogViewVisible},on:{"update:visible":function(e){t.dialogViewVisible=e}}},[a("div",{staticClass:"view-flex"},[a("div",[a("strong",[t._v("Id")]),a("p",[t._v(t._s(t.temp.id))])]),a("div",[a("strong",[t._v("Name")]),a("p",[t._v(t._s(t.temp.attributes.name))])]),a("div",[a("strong",[t._v("Alias")]),a("p",[t._v(t._s(t.temp.attributes.alias))])])])])],1)},[],!1,null,"5a964985",null);u.options.__file="projectsTable.vue";var p=u.exports,f={name:"Filters",mixins:[r.e,r.c,r.a],data:function(){return{type:"projects",searchParams:{date:[],name:"",alias:""}}},computed:n()({},Object(s.b)({filterable:"actionEntityTable/filterable"}),{entity:function(){return{by_name:this.searchParams.name,by_alias:this.searchParams.alias}}}),methods:{clearFilter:function(){this.searchParams={data:[],name:"",alias:""}}}},h=(a("uXUY"),Object(d.a)(f,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"time-entries-filters-container"},[a("div",{staticClass:"time-entries-filters"},[a("div",{staticClass:"filters-label"},[t._v("Name"),a("el-select",{attrs:{filterable:"",remote:"",clearable:"",placeholder:"Please enter a keyword","remote-method":t.remoteGetProjects},on:{focus:t.remoteGetProjects},model:{value:t.searchParams.name,callback:function(e){t.$set(t.searchParams,"name",e)},expression:"searchParams.name"}},t._l(t.filterable("projects"),function(t){return a("el-option",{key:t.id,attrs:{value:t.name,label:t.name}})}))],1)]),a("div",{staticClass:"time-entries-filters"},[a("div",{staticClass:"filters-label"},[t._v("Alias"),a("el-input",{model:{value:t.searchParams.alias,callback:function(e){t.$set(t.searchParams,"alias",e)},expression:"searchParams.alias"}})],1)]),a("div",{staticStyle:{margin:"19px 0 0"}},[a("el-button",{staticClass:"el-button-filter",on:{click:t.filter}},[t._v("Filter")]),a("el-button",{staticClass:"el-button-clear-filter",attrs:{type:"info"},on:{click:t.clearFilter}},[t._v("Clear Filters")])],1)])},[],!1,null,"0c5236de",null));h.options.__file="filters.vue";var m=h.exports,g={name:"Projects",components:{treeTable:l.a,projectsTable:p,filters:m},mixins:[r.a],data:function(){return{type:"dashboardChart",options:[{value:"1",label:"Timebot"},{value:"2",label:"Africar"}],value:"",func:o.a,args:[null,null,"timeLine"]}},computed:n()({},Object(s.b)({list:"actionEntityTable/list",loader:"actionEntityTable/loader"}))},b=(a("h2DJ"),Object(d.a)(g,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:this.loader,expression:"loader"}]},[e("div",{staticClass:"timebot-header"},[this._v("Projects")]),e("filters"),e("projectsTable")],1)},[],!1,null,"182d6af3",null));b.options.__file="index.vue";e.default=b.exports},"6bP5":function(t,e,a){"use strict";var i=a("Qq1u");a.n(i).a},A6Kr:function(t,e,a){"use strict";var i=a("Slkr");a.n(i).a},G2KY:function(t,e,a){"use strict";a.d(e,"a",function(){return d}),a.d(e,"f",function(){return u}),a.d(e,"b",function(){return p}),a.d(e,"d",function(){return f}),a.d(e,"e",function(){return h}),a.d(e,"c",function(){return m});var i=a("4d7F"),n=a.n(i),r=(a("aHnO"),a("P2sY")),s=a.n(r),o=a("QbLZ"),l=a.n(o),c=a("L2JU"),d={data:function(){return{pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()},shortcuts:[{text:"Last week",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"Last month",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"Last 3 months",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},isAnswered:!0}},methods:{formatDate:function(t){if(t){var e=t.getDate();e<10&&(e="0"+e);var a=t.getMonth()+1;a<10&&(a="0"+a);var i=t.getFullYear();return i<10&&(i="0"+i),i+"-"+a+"-"+e}}},computed:l()({},Object(c.b)(["rangeDate"]),{date:{get:function(){return this.rangeDate},set:function(t){this.$store.dispatch("setRangeDate",t)}}}),created:function(){},mounted:function(){if(this.date){var t=new Date("2018-08-18"),e=new Date("2018-08-12");e.setTime(e.getTime()-6048e5),this.$store.dispatch("setRangeDate",[this.formatDate(e),this.formatDate(t)])}}},u={data:function(){var t=function(t,e,a){e?a():a(new Error)},e=function(t,e,a){e?a():a(new Error)};return{rules:{type:[{required:!0,message:"type is required",trigger:"change"}],date:[{validator:e,type:"date",required:!0,message:"Date is required",trigger:"blur"}],time:[{validator:e,type:"datetime",required:!0,message:"Time is required",trigger:"blur"}],title:[{required:!0,message:"title is required",trigger:"blur"}],id:[{validator:t,required:!0,message:"User is required",trigger:"change"}],project:[{validator:function(t,e,a){e?a():a(new Error)},required:!0,message:"Project is required",trigger:"change"}],name:[{validator:t,required:!0,message:"Name of project is requires",trigger:"change"}],team:[{required:!0,message:"Team is requires",trigger:"change"}]}}}},p={data:function(){return{dialogStatus:"",dialogFormVisible:!1,dialogViewVisible:!1,dialogFormLoading:!1,textMap:{update:"Edit",create:"Create",view:"View"},temp:{id:void 0,type:"",date:"",attributes:{"is-active":!1},relationships:{team:{data:{}},user:{data:{}},project:{data:{}}}}}},methods:{handleUpdate:function(t){var e=this;this.temp=s()({},t),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},handleCreate:function(){var t=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},handleView:function(t){this.temp=s()({},t),this.dialogStatus="view",this.dialogViewVisible=!0},resetTemp:function(){this.temp={id:void 0,type:"",date:"",attributes:{"is-active":!1},relationships:{team:{data:{}},user:{data:{}},project:{data:{}}}}}}},f={data:function(){return{}},methods:{handleSizeChange:function(t){var e=this;this.$store.dispatch("actionEntityTable/setPagination",{type:"limit",value:t}).then(function(){e.getList()})},handleCurrentChange:function(t){var e=this;this.$store.dispatch("actionEntityTable/setPagination",{type:"page",value:t}).then(function(){e.getList()})}}},h={beforeDestroy:function(){this.$store.dispatch("actionEntityTable/clearStore")},methods:{getList:function(){var t=this;return new n.a(function(e,a){t.$store.dispatch("actionEntityTable/setLoader",!0),t.$store.dispatch("actionEntityTable/fetchList",t.type).then(function(){t.$store.dispatch("actionEntityTable/setLoader",!1),e()})})},removeEntity:function(t,e){var a=this;this.$confirm("This will permanently delete the entity. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){a.$store.dispatch("actionEntityTable/deleteEntity",{row:t,type:a.type}).then(function(){a.$message({message:"Project was deleted",type:"success"}),t.status=e})}).catch(function(){a.$message({type:"info",message:"Delete canceled"})})},createEntity:function(t){var e=this;return new n.a(function(a,i){e.$refs.dataForm.validate(function(i){i&&(e.dialogFormLoading=!0,e.$store.dispatch("actionEntityTable/createEntity",{row:t,type:e.type}).then(function(t){e.dialogFormVisible=!1,e.dialogFormLoading=!1,e.$notify({title:"Success",message:e.setMessageName(e.type)+" was created",type:"success",duration:2e3}),a()}).catch(function(){e.dialogFormVisible=!1,e.dialogFormLoading=!1}))})})},updateEntity:function(t){var e=this;this.$refs.dataForm.validate(function(a){a&&(e.dialogFormLoading=!0,e.$store.dispatch("actionEntityTable/updateEntity",{row:t,type:e.type}).then(function(){e.dialogFormVisible=!1,e.dialogFormLoading=!1,e.$notify({title:"Success",message:e.setMessageName(e.type)+" was updated",type:"success",duration:2e3})}).catch(function(t){console.log(t),e.dialogFormVisible=!1,e.dialogFormLoading=!1}))})},setMessageName:function(t){switch(t){case"projects":return"Project";case"time-entries":return"Time entry";case"users":return"User";case"teams":return"Team";case"holidays":return"Holiday";case"absences":return"Absence";case"admins":return"Admin"}},remoteGetProjects:function(t){var e=this;"string"!=typeof t&&(t=this.temp&&this.getIncluded(this.temp.relationships.project.data.id)||""),this.loading=!0,this.$store.dispatch("actionEntityTable/fetchEntityByName",{type:"projects",query:t}).then(function(){e.loading=!1})},remoteGetUsers:function(t){var e=this;"string"!=typeof t&&(t=this.temp&&this.getIncluded(this.temp.relationships.user.data.id)||""),this.loading=!0,this.$store.dispatch("actionEntityTable/fetchEntityByName",{type:"users",query:t}).then(function(){e.loading=!1})},filter:function(){var t=this;return new n.a(function(e,a){t.$store.dispatch("actionEntityTable/setLoader",!0),t.$store.dispatch("actionEntityTable/setFilter",t.entity).then(function(){t.$store.dispatch("actionEntityTable/fetchList",t.type).finally(function(){t.$store.dispatch("actionEntityTable/setLoader",!1),e()})})})}}},m={methods:{getIncluded:function(t){if(this.included(this.type)){var e=this.included(this.type).find(function(e){if(e.id===t)return e});if(e)return e.attributes.name}}}}},Gl6u:function(t,e,a){},"MWG/":function(t,e,a){},Mz3J:function(t,e,a){"use strict";var i=a("QbLZ"),n=a.n(i),r=a("G2KY"),s=a("L2JU"),o={name:"Pagination",mixins:[r.d,r.e],props:{type:{type:String,require:!0,default:""}},computed:n()({},Object(s.b)({pagination:"actionEntityTable/pagination"})),methods:{handleSizeChange:function(t){var e=this;this.$store.dispatch("actionEntityTable/setPagination",{limit:t}).then(function(){e.$store.dispatch("actionEntityTable/setLoader",!0),e.getList().then(function(){e.$store.dispatch("actionEntityTable/setLoader",!1)})})},handleCurrentChange:function(t){var e=this;this.$store.dispatch("actionEntityTable/setPagination",{page:t}).then(function(){e.$store.dispatch("actionEntityTable/setLoader",!0),e.getList().then(function(){e.$store.dispatch("actionEntityTable/setLoader",!1),e.$scrollTo("body",1e3)})})}}},l=(a("A6Kr"),a("KHd+")),c=Object(l.a)(o,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pagination-container"},[e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.pagination.total>0,expression:"pagination.total > 0"}],attrs:{"current-page":this.pagination.page,"page-sizes":[10,20,30,50],"page-size":this.pagination.limit,total:this.pagination.total,background:"",layout:"total, sizes, prev, pager, next"},on:{"size-change":this.handleSizeChange,"current-change":this.handleCurrentChange}})],1)},[],!1,null,"26aa7921",null);c.options.__file="index.vue";e.a=c.exports},OBKe:function(t,e,a){},Qq1u:function(t,e,a){},Slkr:function(t,e,a){},aHnO:function(t,e,a){t.exports={default:a("tbFO"),__esModule:!0}},dzVy:function(t,e,a){},h2DJ:function(t,e,a){"use strict";var i=a("Gl6u");a.n(i).a},itRl:function(t,e,a){"use strict";var i=a("jr1U"),n=a.n(i),r=a("rfXi"),s=a.n(r),o=a("Kw5r");function l(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=[];return s()(t).forEach(function(t){void 0===t._expanded&&o.default.set(t,"_expanded",e);var r=1;if(void 0!==i&&null!==i&&(r=i+1),o.default.set(t,"_level",r),a&&o.default.set(t,"parent",a),n.push(t),t.children&&t.children.length>0){var s=l(t.children,e,t,r);n=n.concat(s)}}),n}var c={name:"TreeTable",props:{data:{type:[Array,Object],required:!0},columns:{type:Array,default:function(){return[]}},evalFunc:Function,evalArgs:Array,expandAll:{type:Boolean,default:!1}},computed:{formatData:function(){var t=void 0;t=Array.isArray(this.data)?this.data:[this.data];var e=this.evalFunc||l,a=this.evalArgs?n()([t,this.expandAll],this.evalArgs):[t,this.expandAll];return e.apply(null,a)}},methods:{showRow:function(t){var e=!t.row.parent||t.row.parent._expanded&&t.row.parent._show;return t.row._show=e,e?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},toggleExpanded:function(t){var e=t;e._expanded=!e._expanded},iconShow:function(t,e){return 0===t&&e.children&&e.children.length>0||0===t&&e.time_entries&&e.time_entries.length>0}}},d=(a("6bP5"),a("kLE5"),a("KHd+")),u=Object(d.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",t._b({attrs:{data:t.formatData,"row-style":t.showRow},on:{"row-click":t.toggleExpanded}},"el-table",t.$attrs,!1),[t._l(t.columns,function(e,i){return a("el-table-column",{key:e.value,attrs:{label:e.text,width:e.width},scopedSlots:t._u([{key:"default",fn:function(n){return[t._l(n.row._level,function(e){return 0===i?a("span",{key:e,staticClass:"ms-tree-space"}):t._e()}),t._v("\n      "+t._s(n.row[e.value])+"\n      "),t.iconShow(i,n.row)?a("span",{staticClass:"tree-ctrl",on:{click:function(e){t.toggleExpanded(n.$index)}}},[n.row._expanded?a("i",{staticClass:"el-icon-arrow-up"}):a("i",{staticClass:"el-icon-arrow-down"})]):t._e()]}}])})}),t._v(" "),t._t("default")],2)},[],!1,null,"310c1a60",null);u.options.__file="index.vue";e.a=u.exports},jr1U:function(t,e,a){t.exports={default:a("wObO"),__esModule:!0}},kKwK:function(t,e,a){"use strict";a.d(e,"a",function(){return s});var i=a("rfXi"),n=a.n(i),r=a("Kw5r");function s(t,e,a,i,o){var l=[],c=[];return n()(t).forEach(function(t){void 0===t._expanded&&r.default.set(t,"_expanded",e);var n=1;if(void 0!==i&&null!==i&&(n=i+1),r.default.set(t,"_level",n),a?(r.default.set(t,"parent",a),l[n]||(l[n]=0),r.default.set(t,"_marginLeft",l[n]+a._marginLeft),r.default.set(t,"_width",t[o]/a[o]*a._width),l[n]+=t._width):(l[t.id]=[],l[t.id][n]=0,r.default.set(t,"_marginLeft",0),r.default.set(t,"_width",1)),c.push(t),t.children&&t.children.length>0){var d=s(t.children,e,t,n,o);c=c.concat(d)}}),c}},kLE5:function(t,e,a){"use strict";var i=a("MWG/");a.n(i).a},oOii:function(t,e,a){"use strict";var i=a("dzVy");a.n(i).a},pGU1:function(t,e,a){var i=a("Y7ZC"),n=a("vwuL").f,r=a("5K7Z");i(i.S,"Reflect",{deleteProperty:function(t,e){var a=n(r(t),e);return!(a&&!a.configurable)&&delete t[e]}})},tbFO:function(t,e,a){a("pGU1"),t.exports=a("WEpk").Reflect.deleteProperty},uXUY:function(t,e,a){"use strict";var i=a("OBKe");a.n(i).a},wObO:function(t,e){t.exports=function(){return Function.call.apply(Array.prototype.concat,arguments)}}}]);